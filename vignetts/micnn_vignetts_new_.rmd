---
title: "Multiple instance based deep classification for mass spectrometry imaging"
author: "Dan Guo"
date: "5/26/2022"
output:
  BiocStyle::html_document:
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
---

```{r style, echo=FALSE, results='asis'}
BiocStyle::markdown()
library(knitr)
knitr::knit_engines$set(python = reticulate::eng_python)
```

```{r setup, echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE}
library("CardinalNN") 
use_python("/usr/local/bin/python3")
```


# Introduction


*CardinalNN* is a side package of *Cardinal*. It provides both semi-supervised and fully-supervised deep learning methods for tissue classification using Mass Spectrometry Imaging (MSI) data. The neural network used as classifier is convolutional neural network (CNN). 

- _Fully supervised_. It is the same as standard supervised classification and it is used when the ground-truth labels of pixels are known.

- _Multiple instance_. It is semi-supervised classification and it is used when only the ground-truth labels of tissues are known while no labels for pixels. The assumption is that positive tissues can contain both positive and negative pixels, while negative tissues can only contain negative pixels.


# Installation

The methods in *CardinalNN* are implemented in R but the deep learning methods 
are available in Python. As such, CadinalNN uses the implementation in Python 
but the user does not need any knowledge of Python. It is fully executed from 
within R. However, both Python and a few packages need to be installed and are 
described below. 


## R side of things 

*CardinalNN* can be installed through [GitHub](https://github.com/DanGuo1223/CardinalNN) 
using `devtools`. 

```{r install, eval=FALSE} 
if (!require("devtools", quietly = TRUE))
    install.packages("devtools") 
devtools::install_github("https://github.com/DanGuo1223/CardinalNN")
```


*CardinalNN* will also be distributed through the [Bioconductor](https://bioconductor.org) project in the 
future and could be installed as below. 

```{r, eval=FALSE}
install.packages("BiocManager")
BiocManager::install(version="devel")
BiocManager::install("CardinalNN")
```

The same function can be used to update *CardinalNN* and other Bioconductor packages.

Once installed, *CardinalNN* can be loaded with `library()`:

```{r library, eval=FALSE}
library("CardinalNN")
```


## Python side of things 

The python package, `DeepMSI` is installed in two steps. 

1. **Download Python**: If you already have python installed, skip this step. 
Download python3 from [this download link](https://www.python.org/downloads/) 
and follow the instructions. If you are on a Windows machine, depending upon 
your OS version, you should select the appropriate Python version to download. 
    * Windows 8 and later: you can install the latest stable release. 
    * Windows XP through Windows 7: the latest version you can install is 
    Python 3.8.10.

2. Download `DeepMSI` package from GitHub and install the package. 
    * Go to this [GitHub repository](https://github.com/DanGuo1223/DeepMSI/) 
    and click on the drop down menu **Code** in green color. Select 
    **Download ZIP** to download the package. 
    * Go to your Downloads folder and extract the downloaded files from the 
    zip file (DeepMSI.zip). 
    * If you are on a Mac or Linux computer, 
        * Open the terminal app ([MacOS help](https://support.apple.com/guide/terminal/open-or-quit-terminal-apd5265185d-f365-44cb-8b09-71a064a42125/mac)) 
        and navigate to the extracted folder directory using `cd` (for example, 
        if your downloads folder is `~/Downloads`, use the command 
        `cd ~/Downloads/DeepMSI/`). 
        * Install the package using `sudo python3 setup.py install` (if you 
        do not have sudo privilages for the computer, please contact your 
        adminstrator). 
    * If you are on a Windows computer, 
        * Open the terminal app ([Windows help](https://docs.microsoft.com/en-us/windows/terminal/install#invoke-the-command-palette)) 
        and navigate to the extracted folder directory using `cd` (for example, 
        if your downloads folder is `~\Downloads`, use the command 
        `cd %userprofile%\Downloads\DeepMSI`).  
        * Install the package using `py setup.py install`


